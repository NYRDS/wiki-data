
<h1 class="sectionedit1" id="ballistica">Ballistica</h1>
<div class="level1">

<p>
Ballistica is the line-of-sight and trajectory calculation system used in Remixed Dungeon. It implements a digital differential analyzer (DDA) algorithm to determine the path between two points, taking into account obstacles and blocking terrain.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Ballistica&quot;,&quot;hid&quot;:&quot;ballistica&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-275&quot;} -->
<h3 class="sectionedit2" id="mechanics">Mechanics</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <strong>Digital Differential Analyzer (DDA):</strong> Uses a line-drawing algorithm to trace a path between two points</div>
</li>
<li class="level1"><div class="li"> <strong>Obstacle Detection:</strong> Returns the last traversable cell when encountering blocking terrain</div>
</li>
<li class="level1"><div class="li"> <strong>Character Blocking:</strong> Can optionally stop at characters in the path (depending on the hitChars parameter)</div>
</li>
<li class="level1"><div class="li"> <strong>Object Blocking:</strong> Can optionally stop at level objects (depending on the hitObjects parameter)</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Mechanics&quot;,&quot;hid&quot;:&quot;mechanics&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;276-717&quot;} -->
<h3 class="sectionedit3" id="technical_implementation">Technical Implementation</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <strong>Static Class:</strong> Contains static methods and variables for path calculation</div>
</li>
<li class="level1"><div class="li"> <strong>Trace Array:</strong> Stores the calculated path in the static &#039;trace&#039; array up to the &#039;distance&#039; variable</div>
</li>
<li class="level1"><div class="li"> <strong>Parameters:</strong> The cast method accepts parameters to determine if magic (can pass through some obstacles), whether to hit characters, and whether to hit objects</div>
</li>
<li class="level1"><div class="li"> <strong>Algorithm:</strong> Implements an optimized version of Bresenham&#039;s line algorithm with obstacle detection</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Technical Implementation&quot;,&quot;hid&quot;:&quot;technical_implementation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;718-1211&quot;} -->
<h3 class="sectionedit4" id="usage_in_game">Usage in Game</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="https://www.nyrds.net/doku.php?id=rpd:wands" class="wikilink1" title="rpd:wands" data-wiki-id="rpd:wands">Wands</a> - For determining wand bolt trajectories</div>
</li>
<li class="level1"><div class="li"> <a href="https://www.nyrds.net/doku.php?id=rpd:throwing_weapons" class="wikilink1" title="rpd:throwing_weapons" data-wiki-id="rpd:throwing_weapons">Throwing weapons</a> - For projectile paths</div>
</li>
<li class="level1"><div class="li"> <a href="https://www.nyrds.net/doku.php?id=rpd:spells" class="wikilink1" title="rpd:spells" data-wiki-id="rpd:spells">Spells</a> - For directional spell effects like Magic Arrow</div>
</li>
<li class="level1"><div class="li"> <a href="https://www.nyrds.net/doku.php?id=rpd:traps" class="wikilink2" title="rpd:traps" rel="nofollow" data-wiki-id="rpd:traps">Traps</a> - For effect trajectories like Warden&#039;s roots</div>
</li>
<li class="level1"><div class="li"> <strong>Ranged combat</strong> - For determining if a ranged attack can reach its target</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Usage in Game&quot;,&quot;hid&quot;:&quot;usage_in_game&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;1212-1595&quot;} -->
<h3 class="sectionedit5" id="api">API</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <strong>cast(int from, int to, boolean magic, boolean hitChars, boolean hitObjects):</strong> Main method that calculates the trajectory</div>
</li>
<li class="level1"><div class="li"> <strong>trace[]:</strong> Static array containing the calculated path points</div>
</li>
<li class="level1"><div class="li"> <strong>distance:</strong> Static variable containing the length of the calculated path</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;API&quot;,&quot;hid&quot;:&quot;api&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;1596-1885&quot;} -->
<h3 class="sectionedit6" id="content_verification">Content Verification</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Information source: Java Class com.watabou.pixeldungeon.mechanics.Ballistica</div>
</li>
<li class="level1"><div class="li"> Implementation details based on code analysis of Ballistica.java</div>
</li>
<li class="level1"><div class="li"> Parameters and functionality verified against actual source code</div>
</li>
<li class="level1"><div class="li"> Last updated: Based on current git repository state</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Content Verification&quot;,&quot;hid&quot;:&quot;content_verification&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;1886-2192&quot;} -->
<h3 class="sectionedit7" id="source_code">Source Code</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/java/com/watabou/pixeldungeon/mechanics/Ballistica.java" class="urlextern" title="https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/java/com/watabou/pixeldungeon/mechanics/Ballistica.java">Ballistica.java on GitHub</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Source Code&quot;,&quot;hid&quot;:&quot;source_code&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;2193-2383&quot;} -->
<h3 class="sectionedit8" id="strategy">Strategy</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Understanding line of sight can help predict when ranged attacks will be blocked</div>
</li>
<li class="level1"><div class="li"> Positioning behind corners can block enemy ranged attacks using obstacles</div>
</li>
<li class="level1"><div class="li"> Diagonal positioning can sometimes provide cover while still allowing attacks</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Strategy&quot;,&quot;hid&quot;:&quot;strategy&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;2384-2648&quot;} -->
<h3 class="sectionedit9" id="see_also">See Also</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="https://www.nyrds.net/doku.php?id=rpd:range" class="wikilink1" title="rpd:range" data-wiki-id="rpd:range">Range</a> - Understanding distance mechanics</div>
</li>
<li class="level1"><div class="li"> <a href="https://www.nyrds.net/doku.php?id=rpd:combat" class="wikilink1" title="rpd:combat" data-wiki-id="rpd:combat">Combat</a> - Combat mechanics</div>
</li>
<li class="level1"><div class="li"> <a href="https://www.nyrds.net/doku.php?id=rpd:mechanics" class="wikilink1" title="rpd:mechanics" data-wiki-id="rpd:mechanics">Mechanics</a> - General game mechanics</div>
</li>
<li class="level1"><div class="li"> <a href="https://www.nyrds.net/doku.php?id=rpd:los_blocking" class="wikilink2" title="rpd:los_blocking" rel="nofollow" data-wiki-id="rpd:los_blocking">LOS Blocking</a> - Objects that block line of sight</div>
</li>
</ul>
<div class="tags"><span>
	<a href="https://www.nyrds.net/doku.php?id=tag:rpd&amp;do=showtag&amp;tag=rpd" class="wikilink1" title="tag:rpd" rel="tag">rpd</a>,
	<a href="https://www.nyrds.net/doku.php?id=tag:mechanics&amp;do=showtag&amp;tag=mechanics" class="wikilink1" title="tag:mechanics" rel="tag">mechanics</a>,
	<a href="https://www.nyrds.net/doku.php?id=tag:combat&amp;do=showtag&amp;tag=combat" class="wikilink1" title="tag:combat" rel="tag">combat</a>,
	<a href="https://www.nyrds.net/doku.php?id=tag:targeting&amp;do=showtag&amp;tag=targeting" class="wikilink1" title="tag:targeting" rel="tag">targeting</a>,
	<a href="https://www.nyrds.net/doku.php?id=tag:los&amp;do=showtag&amp;tag=los" class="wikilink1" title="tag:los" rel="tag">los</a>
</span></div>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;See Also&quot;,&quot;hid&quot;:&quot;see_also&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:9,&quot;range&quot;:&quot;2649-&quot;} -->