====== Scroll of Magic Mapping ======

{{ rpd:images:scroll_magic_mapping.png|Scroll of Magic Mapping }}

The Scroll of Magic Mapping is a magical item that reveals the layout of the current dungeon floor, showing all hidden doors and traps. It also disarms all visible traps on the current floor.

==== Description ====
When read, the Scroll of Magic Mapping reveals the entire layout of the current floor, showing all rooms, corridors, doors, and secret passages that were previously hidden. It also disarms all visible traps on the floor.

==== Effects ====
  * **Full Map Reveal**: Reveals the entire current floor layout
  * **Hidden Doors**: Reveals all hidden doors and secret passages
  * **Trap Disarmament**: Disarms all visible traps on the current floor
  * **No Effect on Enemies**: Does not affect enemy positions or behavior

==== Strategy ====
  * **Exploration**: Essential for mapping out unknown areas
  * **Safety**: Helps avoid dangerous areas and traps
  * **Planning**: Enables planning of safe routes and escape paths
  * **Resource Management**: Best saved for important moments when mapping is needed

==== Code References ====
<code java>
package com.watabou.pixeldungeon.items.scrolls;

import com.watabou.pixeldungeon.Dungeon;
import com.watabou.pixeldungeon.actors.buffs.Invisibility;
import com.watabou.pixeldungeon.actors.hero.Hero;
import com.watabou.pixeldungeon.levels.Level;
import com.watabou.pixeldungeon.levels.Terrain;
import com.watabou.pixeldungeon.scenes.GameScene;
import com.watabou.pixeldungeon.utils.GLog;

public class ScrollOfMagicMapping extends Scroll {

	@Override
	protected void doRead() {
		
		int length = Level.getLength();
		boolean[] mapped = new boolean[length];
		
		for (int i=0; i < length; i++) {
			
			int terr = Dungeon.level.map[i];
			if (terr == Terrain.WALL_DECO || terr == Terrain.EMPTY_DECO) {
				mapped[i] = true;
			} else if (terr == Terrain.SECRET_DOOR) {
				mapped[i] = true;
				Dungeon.level.set( i, Terrain.DOOR );
				GameScene.updateMap( i );
			} else if (terr == Terrain.SECRET_TOXIC_TRAP) {
				mapped[i] = true;
				Dungeon.level.set( i, Terrain.TOXIC_TRAP );
				GameScene.updateMap( i );
			} else if (terr == Terrain.SECRET_FIRE_TRAP) {
				mapped[i] = true;
				Dungeon.level.set( i, Terrain.FIRE_TRAP );
				GameScene.updateMap( i );
			} else if (terr == Terrain.SECRET_POISON_TRAP) {
				mapped[i] = true;
				Dungeon.level.set( i, Terrain.POISON_TRAP );
				GameScene.updateMap( i );
			} else if (terr == Terrain.SECRET_ALARM_TRAP) {
				mapped[i] = true;
				Dungeon.level.set( i, Terrain.ALARM_TRAP );
				GameScene.updateMap( i );
			} else if (terr == Terrain.SECRET_LIGHT_TRAP) {
				mapped[i] = true;
				Dungeon.level.set( i, Terrain.LIGHT_TRAP );
				GameScene.updateMap( i );
			} else if (terr == Terrain.SECRET_GRIPPING_TRAP) {
				mapped[i] = true;
				Dungeon.level.set( i, Terrain.GRIPPING_TRAP );
				GameScene.updateMap( i );
			} else if (terr == Terrain.SECRET_SUMMONING_TRAP) {
				mapped[i] = true;
				Dungeon.level.set( i, Terrain.SUMMONING_TRAP );
				GameScene.updateMap( i );
			}
		}
		
		Buff.detach( curUser, Invisibility.class );
		
		Dungeon.observe();
		GameScene.updateFog();
		
		GLog.h( "You are now aware of the level layout." );
		setKnown();
		
		((ScrollOfMagicMapping)curItem).readAnimation();
	}
	
	@Override
	public String desc() {
		return
			"The magic mapping spell reveals the complete layout of the current floor, " +
			"including hidden doors and traps. The locations of items and creatures remain unknown.";
	}
}
</code>

  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/java/com/watabou/pixeldungeon/items/scrolls/ScrollOfMagicMapping.java|ScrollOfMagicMapping.java]] - Main implementation

==== Related Items ====
  * [[rpd:scrolls|Scrolls]] - List of all scrolls
  * [[rpd:map|Dungeon Map]] - General information about dungeon mapping

{{tag> rpd items scrolls mapping}}