====== Backstab Spell - Code References ======

===== Java Classes =====
  * No dedicated Java class - This spell is implemented entirely in Lua
  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/java/com/nyrds/pixeldungeon/mechanics/spells/Spell.java|Spell.java]] - Base spell class for all Lua-based spells

===== JSON Configuration =====
This entity is implemented in Lua, no JSON configuration exists

===== String Resources =====
  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/res/values/strings_all.xml#L2633-L2636|strings_all.xml#L2633-L2636]] (English)
  * ''Backstab_Name'': "Backstab"
  * ''Backstab_Info'': "Silent hit in the back. Dishonest, but extremely effective, backstab damage will grow with performer skill level.\n\nSuccessful backstab will completely ignore victim armor or special defense abilities."
  * ''Backstab_TooFar'': "Victim too far for successful hit."
  * ''Backstab_Aware'': "Victim shouldn't be aware of you for a good backstab."

  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/res/values-ru/strings_all.xml#L103-L106|strings_all.xml#L103-L106]] (Russian)
  * ''Backstab_Name'': "Удар в спину"
  * ''Backstab_Info'': "Бесшумный удар в спину. Бесчестно, но весьма эффективно, урон от закалывания растет вместе с уровнем мастерства.\n\nУспешный удар в спину полностью игнорирует броню или специальные защитные техники жертвы."

  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/res/values-es/strings_all.xml#L101-L104|strings_all.xml#L101-L104]] (Spanish)
  * ''Backstab_Name'': "Puñalada por la espalda"

  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/res/values-de/strings_all.xml#L100-L103|strings_all.xml#L100-L103]] (German)
  * ''Backstab_Name'': "Meucheln"

  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/res/values-fr/strings_all.xml#L98-L101|strings_all.xml#L98-L101]] (French)
  * ''Backstab_Name'': "Coup dans le dos"

  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/res/values-pt-rBR/strings_all.xml#L92-L95|strings_all.xml#L92-L95]] (Portuguese BR)
  * ''Backstab_Name'': "Apunhalar"

  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/res/values-ja/strings_all.xml#L98-L101|strings_all.xml#L98-L101]] (Japanese)
  * ''Backstab_Name'': "バックスタブ"

  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/res/values-zh-rCN/strings_all.xml#L93-L96|strings_all.xml#L93-L96]] (Chinese Simplified)
  * ''Backstab_Name'': "背刺"

===== Lua Scripts =====
  * [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/assets/scripts/spells/Backstab.lua|Backstab.lua]] - Main spell implementation

  **Key Functions:**
  * ''desc()'' - Returns spell configuration (image, name, info, magicAffinity, targetingType, level, castTime, spellCost)
  * ''cast()'' - Executes the backstab attack logic

  **Spell Configuration:**
  * ''magicAffinity'': "Rogue" - Only usable by Rogue class and subclasses
  * ''targetingType'': "self" - Targets caster's position
  * ''level'': 2 - Spell level requirement
  * ''castTime'': 1 - Cast time in turns
  * ''spellCost'': 2 - Mana cost
  * ''image'': 2 - Sprite index in spellsIcons/rogue.png
  * ''imageFile'': "spellsIcons/rogue.png" - Sprite sheet location

===== Spell Mechanics =====
  * **Distracted States**: PASSIVE, SLEEPING, FLEEING, HORRIFIED, RUNNINGAMOK
  * **Alternative Condition**: Target can also be paralyzed
  * **Range**: 1 tile distance (adjacent to caster)
  * **Damage Formula**: math.sqrt(caster:skillLevel()) * (weapon:damageRoll(caster) + secondaryWeapon:damageRoll(caster))
    - Scales with square root of caster's skill level
    - Uses both main hand and offhand weapon damage
  * **Armor Penetration**: Completely ignores victim armor and special defense abilities
  * **Visual Effect**: Shows "backstab" status text on victim (color: 0xff2030 - red)
  * **Sound Effect**: RPD.Sfx.Wound:hit(victim) plays on successful hit

===== Requirements for Successful Cast =====
  1. Target must be within 1 tile distance
  2. Target must be in a distracted state OR paralyzed
  3. Caster must have a weapon equipped
  4. Caster must have sufficient mana (2 points)
  5. Caster must be Rogue class or have Rogue magic affinity

===== Failure Conditions =====
  * ''Backstab_TooFar'': Displayed when target is more than 1 tile away
  * ''Backstab_Aware'': Displayed when target is aware and not distracted/paralyzed

===== Related mr Entities =====
  * [[mr:rogue_class|Rogue (Class)]] - Primary class that can use this spell
  * [[mr:assassin_subclass|Assassin (Subclass)]] - Rogue subclass with enhanced backstab capabilities
  * [[mr:backstab_buff|Backstab (Buff)]] - Status effect applied to victim