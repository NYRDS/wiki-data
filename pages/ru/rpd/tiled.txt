====== Tiled ======
 
(с плагином для экспорта карт для Remixed Pixel Dungeon)

Для упрощения процесса создания пользовательских карт для rpd, а так же для добавления нового функционала, в виде нестандартного набора тайлов, мы создали сборку open source редактора карт "Tiled", с поддержкой формата уровней rpd.

Теперь, чтобы создавать собственные карты для rpd, достаточно скачать нашу сборку: [[https://drive.google.com/uc?export=download&id=1LIu8hlG519LhieMryHHQfpdpvUgRRAiR|Tiled_rpd]]. И следовать инструкциям.
 
**Внимание: Для работы приложения требуется операционная система Windows!**

Пользователи Linux смогут без труда собрать его выкачав [[https://github.com/NYRDS/tiled|исходный код]]

===== Подготовка к созданию карты =====

Для того чтобы начать создание карты нужно запустить tiled.exe (внезапно) и создать новый проект:

**Файл -> New -> New map**

В настройках новой карты необходимо выставить опции:

**Ориентация**: Ортогональная
**Порядок отображения тайлов**: Слева сверху

**Размер тайлов**:
**Ширина**: 16 px
**Высота**: 16 px

**Размер карты**: по желанию

{{:ru:rpd:tiled_guide_new_map.png?nolink|}}

Сохраняем проект под желанным именем, и таким образом мы имеем готовую площадку для создания карты.

==== Создание карты ====

Для того чтобы создать карту, необходимо нарисовать её на логическом слое. Для этого нужно переименовать слой созданный по умолчанию (1.) или создать новый слой (2.) и назвать его "logic" (обязательно с маленькой буквы). 

{{:ru:rpd:tiled_guide_new_layer.png?direct&200|}}

Далее необходимо загрузить желанный тайл сет из стандартных или созданный в формате стандартных (без отметки x). [[https://github.com/NYRDS/remixed-dungeon/blob/master/RemixedDungeon/src/main/assets/tiles0.png|Пример]]. Важно по-прежнему ставить размеры тайлов 16х16, а также желательно поставить цвет прозрачности чёрный (Это некритично, но так будет удобнее, конечно если чёрный цвет используется на тайлах, он станет прозрачным в редакторе, но в игре это никак не отразится)

{{:ru:rpd:tiled_guide_new_tileset.png?direct&200|}}

Сохраняем тайлсет под желаемым именем, после чего возвращаемся на вкладочку, где производится редактирование карты

{{:ru:rpd:tiled_guide_back_to_map.png?direct&200|}}

Далее рисуем карту. Для этого нам окажутся особо полезны следующие элементы:

1. **Штамп** - рисует на карте выбранный тайл или набор тайлов (если на палитре тайлов было выделено больше одного тайла)

2. **Заливка** - "заливает" выбранным тайлом выбранную зону карты

3. **Выделение** - позволяет выбрать группу тайлов на карте, например, чтобы удалить их все скопом

4. **Вкладка "Наборы тайлов"** - если эта вкладка не будет выбрана, то мы не увидим нашу палитру тайлов, которая находится в этом же углу

{{:ru:rpd:tiled_guide_legend.png?direct&200|}}

После того как мы нарисовали карту, необходимо выбрать опцию экспортировать как

{{:ru:rpd:tiled_guide_export_as.png?direct&200|}}

И в поле тип файла выбрать: **Remixed Pixel Dungeon levels**

{{:ru:rpd:tiled_guide_export_as_type.png?direct&200|}}

После чего получаем файл json, который используется, как и любая другая созданная вручную карта rpd.

==== Добавление уникальных тайлов ====

Также появилась новая возможность: создать карту с нестандартным тайлсетом. Т.е вы можете рисовать несколько типов полов, стен, разные элементы интерьера (ёлки, снеговики). Для того чтобы сделать это, нужна уже готовая заготовка стандартной карты, описанная выше. Так как слой "logic" - есть логическая карта, т.е при использовании уникального тайлсета, этот слой рисоваться не будет. В деталях всё будет далее:

Для начала необходимо, известным нам способом, добавить свой уникальный тайл сет.

{{:ru:rpd:tiled_guide_new_tileset.png?direct&200|}}

Создать слой "base". base является основой декоративного слоя, как правило, на нём нужно рисовать пол и куски стен и интерьера которые не имеют прозрачных частей, и где вы будете размещать дополнительные элементы (двери, окна и т.д.)

{{:ru:rpd:tiled_guide_base.png?direct&200|}}

Создать слой "deco". deco является вторым декоративным слоем, который накладывается поверх "base". Именно здесь нужно рисовать вышеуказанные двери, деревья и прочие тайлы с прозрачными элементами. Потому что если вы разместите их на слое "base", то прозрачные элементы так и будут прозрачными в игре.

{{:ru:rpd:tiled_guide_deco.png?direct&200|}}

Соответственно, сделав это, в слое "logic" достаточно обрисовать все непроходимые участки — стенами, проходимые — полом, спуски — спусками и подъём — подъёмом. Как показано на скриншоте.

{{:ru:rpd:tiled_guide_logic.png?direct&200|}}

И если мы спрячем в редакторе слой "logic" и оставим другие два, то мы получим вот такую красивую картинку, которая, если всё сделано правильно отобразится в игре

{{:ru:rpd:tiled_guide_pretty.png?direct&200|}}

Для чего мы вновь должны экспортировать проект в формате **Remixed Pixel Dungeon levels**. И на выходе получаем файл следующего содержания:

{{:ru:rpd:tiled_guide_deco_export.png?direct&200|}}

Где есть два важных параметра,

"customTiles":true - показатель того, что на карте используются уникальные тайлы, в нашем случае элементы деревушки

"tiles":"Citywip.png" - путь к файлу с уникальными тайлами в вашем моде

=== Слои карты ===

  * logic (это базовые тайлы)
  * base
  * deco
  * deco2 - эти слои рисуются под героем


  *  roof_base
  *  roof_deco - эти слои рисуются над героем

Ещё есть mobs и objects, но чтобы их использовать нужны прописанные свойства в тайлсетах.
Карты и тайлсеты живут тут: [[https://github.com/NYRDS/remixed-dungeon/tree/master/TiledMaps]].


Удачного картостроения! 

Если что не понятно или не приятно пишите в группу: https://vk.com/rpd_modding  и гайд будет пополнятся и прихорашиваться.